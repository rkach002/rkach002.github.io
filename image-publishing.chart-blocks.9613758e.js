!function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function t(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}var e=t((function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},e(n)}t.exports=e}));var n=function(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=e(t)););return t},r=(t((function(t){function e(r,o,a){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=e=Reflect.get:t.exports=e=function(t,e,r){var o=n(t,e);if(o){var a=Object.getOwnPropertyDescriptor(o,e);return a.get?a.get.call(r):a.value}},e(r,o,a||r)}t.exports=e})),t((function(t){function e(n,r){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(n,r)}t.exports=e})));var o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)},a=t((function(t){function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(n)}t.exports=e}));var i=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var c=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?i(t):e};var u=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")};var f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}},l=t((function(t){function e(n,o,a){return f()?t.exports=e=Reflect.construct:t.exports=e=function(t,e,n){var o=[null];o.push.apply(o,e);var a=new(Function.bind.apply(t,o));return n&&r(a,n.prototype),a},e.apply(null,arguments)}t.exports=e})),s=t((function(t){function n(o){var a="function"==typeof Map?new Map:void 0;return t.exports=n=function(t){if(null===t||!u(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==a){if(a.has(t))return a.get(t);a.set(t,n)}function n(){return l(t,arguments,e(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),r(n,t)},n(o)}t.exports=n}));var p=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r};var d=function(t){if(Array.isArray(t))return p(t)};var h=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)};var y=function(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}};var m=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var b=function(t){return d(t)||h(t)||y(t)||m()};var g=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var w,x=function(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),t};function O(){}function $(t){return t()}function S(){return Object.create(null)}function j(t){t.forEach($)}function D(t){return"function"==typeof t}function k(t,e){return t!=t?e==e:t!==e||t&&"object"===a(t)||"function"==typeof t}function E(t,e,n){t.insertBefore(e,n||null)}function P(t){t.parentNode.removeChild(t)}function R(t){return document.createElement(t)}function T(t,e,n,r){return t.addEventListener(e,n,r),function(){return t.removeEventListener(e,n,r)}}function _(t){return function(e){return e.preventDefault(),t.call(this,e)}}function C(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function U(t){return Array.from(t.childNodes)}function A(t){w=t}var L=[],F=[],I=[],B=[],M=Promise.resolve(),H=!1;function N(t){I.push(t)}var q=!1,G=new Set;function J(){if(!q){q=!0;do{for(var t=0;t<L.length;t+=1){var e=L[t];A(e),K(e.$$)}for(L.length=0;F.length;)F.pop()();for(var n=0;n<I.length;n+=1){var r=I[n];G.has(r)||(G.add(r),r())}I.length=0}while(L.length);for(;B.length;)B.pop()();H=!1,q=!1,G.clear()}}function K(t){if(null!==t.fragment){t.update(),j(t.before_update);var e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(N)}}var V=new Set;function X(t,e){t&&t.i&&(V.delete(t),t.i(e))}function z(t,e,n){var r=t.$$,o=r.fragment,a=r.on_mount,i=r.on_destroy,c=r.after_update;o&&o.m(e,n),N((function(){var e=a.map($).filter(D);i?i.push.apply(i,b(e)):j(e),t.$$.on_mount=[]})),c.forEach(N)}function W(t,e){-1===t.$$.dirty[0]&&(L.push(t),H||(H=!0,M.then(J)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Z(t,e,n,r,o,a){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[-1],c=w;A(t);var u=e.props||{},f=t.$$={fragment:null,ctx:null,props:a,update:O,not_equal:o,bound:S(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:[]),callbacks:S(),dirty:i},l=!1;if(f.ctx=n?n(t,u,(function(e,n){var r=!(arguments.length<=2)&&arguments.length-2?arguments.length<=2?void 0:arguments[2]:n;return f.ctx&&o(f.ctx[e],f.ctx[e]=r)&&(f.bound[e]&&f.bound[e](r),l&&W(t,e)),n})):[],f.update(),l=!0,j(f.before_update),f.fragment=!!r&&r(f.ctx),e.target){if(e.hydrate){var s=U(e.target);f.fragment&&f.fragment.l(s),s.forEach(P)}else f.fragment&&f.fragment.c();e.intro&&X(t.$$.fragment),z(t,e.target,e.anchor),J()}A(c)}var Q=function(){function t(){g(this,t)}return x(t,[{key:"$destroy",value:function(){var t,e;t=1,null!==(e=this.$$).fragment&&(j(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[]),this.$destroy=O}},{key:"$on",value:function(t,e){var n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}}},{key:"$set",value:function(){}}]),t}(),Y=t((function(t,e){t.exports=function t(e,n,r){var o,a,i=window,c="application/octet-stream",u=r||c,f=e,l=!n&&!r&&f,s=document.createElement("a"),p=function(t){return String(t)},d=i.Blob||i.MozBlob||i.WebKitBlob||p,h=n||"download";if(d=d.call?d.bind(i):Blob,"true"===String(this)&&(u=(f=[f,u])[0],f=f[1]),l&&l.length<2048&&(h=l.split("/").pop().split("?")[0],s.href=l,-1!==s.href.indexOf(l))){var y=new XMLHttpRequest;return y.open("GET",l,!0),y.responseType="blob",y.onload=function(e){t(e.target.response,h,c)},setTimeout((function(){y.send()}),0),y}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(f)){if(!(f.length>2096103.424&&d!==p))return navigator.msSaveBlob?navigator.msSaveBlob(v(f),h):w(f);u=(f=v(f)).type||c}else if(/([\x80-\xff])/.test(f)){for(var m=0,b=new Uint8Array(f.length),g=b.length;m<g;++m)b[m]=f.charCodeAt(m);f=new d([b],{type:u})}function v(t){for(var e=t.split(/[:;,]/),n=e[1],r=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),o=r.length,a=0,i=new Uint8Array(o);a<o;++a)i[a]=r.charCodeAt(a);return new d([i],{type:n})}function w(t,e){if("download"in s)return s.href=t,s.setAttribute("download",h),s.className="download-js-link",s.innerHTML="downloading...",s.style.display="none",document.body.appendChild(s),setTimeout((function(){s.click(),document.body.removeChild(s),!0===e&&setTimeout((function(){i.URL.revokeObjectURL(s.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,c)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,c)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=f instanceof d?f:new d([f],{type:u}),navigator.msSaveBlob)return navigator.msSaveBlob(o,h);if(i.URL)w(i.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===p)try{return w("data:"+u+";base64,"+i.btoa(o))}catch(t){return w("data:"+u+","+encodeURIComponent(o))}(a=new FileReader).onload=function(t){w(this.result)},a.readAsDataURL(o)}return!0}}));var tt=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t};var et=function(t,e){if(null==t)return{};var n,r,o={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(o[n]=t[n]);return o};var nt=function(t,e){if(null==t)return{};var n,r,o=et(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o},rt=t((function(t,e){var n;n=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function a(e,n,a){if("undefined"!=typeof document){"number"==typeof(a=t({path:"/"},o.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var i=JSON.stringify(n);/^[\{\[]/.test(i)&&(n=i)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var c="";for(var u in a)a[u]&&(c+="; "+u,!0!==a[u]&&(c+="="+a[u].split(";")[0]));return document.cookie=e+"="+n+c}}function i(t,n){if("undefined"!=typeof document){for(var o={},a=document.cookie?document.cookie.split("; "):[],i=0;i<a.length;i++){var c=a[i].split("="),u=c.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var f=e(c[0]);if(u=(r.read||r)(u,f)||e(u),n)try{u=JSON.parse(u)}catch(t){}if(o[f]=u,t===f)break}catch(t){}}return t?o[t]:o}}return o.set=a,o.get=function(t){return i(t,!1)},o.getJSON=function(t){return i(t,!0)},o.remove=function(e,n){a(e,"",t(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))},t.exports=n()}));function ot(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=e(t);if(n){var a=e(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return c(this,r)}}function at(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?at(Object(n),!0).forEach((function(e){tt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ct="crumb",ut=new Set(["get","head","options","trace"]);function ft(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.fetch)try{e.fetch=window.fetch}catch(t){throw new Error("Neither options.fetch nor window.fetch is defined.")}if(!e.baseUrl)try{e.baseUrl="//".concat(window.dw.backend.__api_domain)}catch(t){throw new Error("Neither options.baseUrl nor window.dw is defined.")}var n,r=it(it({payload:null,raw:!1,method:"GET",mode:"cors",credentials:"include"},e),{},{headers:it({"Content-Type":"application/json"},e.headers)}),o=r.payload,a=r.baseUrl,i=r.fetch,c=r.raw,u=nt(r,["payload","baseUrl","fetch","raw"]),f="".concat(a.replace(/\/$/,""),"/").concat(t.replace(/^\//,""));if(o&&(u.body=JSON.stringify(o)),ut.has(u.method.toLowerCase()))n=i(f,u);else{var l=rt.get(ct);l?(u.headers["X-CSRF-Token"]=l,n=i(f,u)):n=ft("/v3/me",{fetch:i,baseUrl:a}).then((function(){var t=rt.get(ct);t&&(u.headers["X-CSRF-Token"]=t)})).catch((function(){})).then((function(){return i(f,u)}))}return n.then((function(t){if(c)return t;if(!t.ok)throw new st(t);if(204===t.status||!t.headers.get("content-type"))return t;var e=t.headers.get("content-type").split(";")[0];return"application/json"===e?t.json():"image/png"===e||"application/pdf"===e?t.blob():t.text()}))}ft.get=lt("GET"),ft.patch=lt("PATCH"),ft.put=lt("PUT"),ft.post=lt("POST"),ft.head=lt("HEAD");function lt(t){return function(e,n){if(n&&n.method)throw new Error("Setting option.method is not allowed in httpReq.".concat(t.toLowerCase(),"()"));return ft(e,it(it({},n),{},{method:t}))}}ft.delete=lt("DELETE");var st=function(t){o(n,t);var e=ot(n);function n(t){var r;return g(this,n),(r=e.call(this)).name="HttpReqError",r.status=t.status,r.statusText=t.statusText,r.message="[".concat(t.status,"] ").concat(t.statusText),r.response=t,r}return n}(s(Error));function pt(t){var e,n=t.type,r=t.chart,o=t.imagePrefix,a=t.apiDomain,i=t.downloadFormats,c=function(){var t=!1;try{t=window.parent&&window.parent!==window.self&&window.parent.dw&&window.parent.dw.backend}catch(t){}return t}(),u=c?"".concat(window.location.protocol,"//").concat(a):o;c&&(e=dw.notify({icon:'<i style="margin-right:10px;" class="fa fa-spin fa-circle-o-notch"></i>',translateKey:"chart-notification / download / ".concat(n),closeable:!1}));var f=r.title.replace(/[^\w\d]+/g,"-").toLowerCase(),l=i[n].filename,s=c?"/v3/charts/".concat(r.id,"/export/").concat(n):"/".concat(r.publicId,"/").concat(l,".").concat(n);c?(delete i[n].filename,ft.post(s,{baseUrl:u,raw:!0,payload:i[n]}).then((function(t){return t.blob()})).then((function(t){e(),Y(t,"".concat(f,".").concat(n),"image/".concat(n))})).catch((function(){e(),dw.notify({translateKey:"chart-notification / download / fail / ".concat(n),closeable:!0,type:"error"})}))):ft.get(s,{baseUrl:u,raw:!0}).then((function(t){return t.blob()})).then((function(t){return Y(t,"".concat(f,".").concat(n),"image/".concat(n))})).catch((function(){window.open(s)}))}function dt(t){let e,n,r;return{c(){e=R("a"),C(e,"class","chart-action-image"),C(e,"href","#")},m(o,a){E(o,e,a),e.innerHTML=t[1],n||(r=T(e,"click",_(t[6])),n=!0)},p(t,[n]){2&n&&(e.innerHTML=t[1])},i:O,o:O,d(t){t&&P(e),n=!1,r()}}}function ht(t,e,n){let{props:r}=e;const{get:o,__:a,imagePrefix:i,apiDomain:c,downloadFormats:u}=r;let f,l,s;return t.$set=t=>{"props"in t&&n(5,r=t.props)},t.$$.update=()=>{32&t.$$.dirty&&n(0,f=r.chart),32&t.$$.dirty&&n(7,l=r.theme),128&t.$$.dirty&&n(1,s=o(l,"data.options.blocks.download-image.data.caption",a("Download Image")))},[f,s,i,c,u,r,()=>pt({type:"png",chart:f,imagePrefix:i,apiDomain:c,downloadFormats:u})]}class yt extends Q{constructor(t){super(),Z(this,t,ht,dt,k,{props:5})}}function mt(t){let e,n,r;return{c(){e=R("a"),C(e,"class","chart-action-pdf"),C(e,"href","#")},m(o,a){E(o,e,a),e.innerHTML=t[1],n||(r=T(e,"click",_(t[6])),n=!0)},p(t,[n]){2&n&&(e.innerHTML=t[1])},i:O,o:O,d(t){t&&P(e),n=!1,r()}}}function bt(t,e,n){let{props:r}=e;const{get:o,__:a,imagePrefix:i,apiDomain:c,downloadFormats:u}=r;let f,l,s;return t.$set=t=>{"props"in t&&n(5,r=t.props)},t.$$.update=()=>{32&t.$$.dirty&&n(0,f=r.chart),32&t.$$.dirty&&n(7,l=r.theme),128&t.$$.dirty&&n(1,s=o(l,"data.options.blocks.download-pdf.data.caption",a("Download PDF")))},[f,s,i,c,u,r,()=>pt({type:"pdf",chart:f,imagePrefix:i,apiDomain:c,downloadFormats:u})]}class gt extends Q{constructor(t){super(),Z(this,t,bt,mt,k,{props:5})}}function vt(t){let e,n,r;return{c(){e=R("a"),C(e,"class","chart-action-svg"),C(e,"href","#")},m(o,a){E(o,e,a),e.innerHTML=t[1],n||(r=T(e,"click",_(t[6])),n=!0)},p(t,[n]){2&n&&(e.innerHTML=t[1])},i:O,o:O,d(t){t&&P(e),n=!1,r()}}}function wt(t,e,n){let{props:r}=e;const{get:o,__:a,imagePrefix:i,apiDomain:c,downloadFormats:u}=r;let f,l,s;return t.$set=t=>{"props"in t&&n(5,r=t.props)},t.$$.update=()=>{32&t.$$.dirty&&n(0,f=r.chart),32&t.$$.dirty&&n(7,l=r.theme),128&t.$$.dirty&&n(1,s=o(l,"data.options.blocks.download-svg.data.caption",a("Download SVG")))},[f,s,i,c,u,r,()=>pt({type:"svg",chart:f,imagePrefix:i,apiDomain:c,downloadFormats:u})]}class xt extends Q{constructor(t){super(),Z(this,t,wt,vt,k,{props:5})}}function Ot(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return t;for(var r=e.split("."),o=t,a=0;a<r.length&&null!=o;a++)o=o[r[a]];return null==o?n:o}Object.assign(yt,{test:function(t){var e=t.chart,n=t.isStyleStatic;return!!Ot(e,"metadata.publish.blocks.download-image")&&!n}}),Object.assign(gt,{test:function(t){var e=t.chart,n=t.isStyleStatic;return!!Ot(e,"metadata.publish.blocks.download-pdf")&&!n}}),Object.assign(xt,{test:function(t){var e=t.chart,n=t.isStyleStatic;return!!Ot(e,"metadata.publish.blocks.download-svg")&&!n}}),dw.block.register("DownloadImage",yt),dw.block.register("DownloadPDF",gt),dw.block.register("DownloadSVG",xt)}();
